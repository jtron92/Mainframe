✅ Full Setup: Send Email from z/OS via Postfix on Linux
🧱 Part 1: Install and configure Postfix

    Install Postfix on your Linux machine:

sudo apt install postfix mailutils

    During the Postfix setup:

        Select: "Internet with smarthost"

        Enter your system mail name: e.g., localhost or mainframe.local

        For SMTP relay host, enter:

        [smtp.gmail.com]:587

🛠 Part 2: Configure Gmail as your relay (securely)

    Edit /etc/postfix/main.cf:

sudo nano /etc/postfix/main.cf

Add these lines at the bottom (to avoid duplicates):

# Enable TLS and SASL
smtp_use_tls = yes
smtp_tls_security_level = encrypt
smtp_tls_note_starttls_offer = yes

smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
smtp_sasl_security_options = noanonymous

relayhost = [smtp.gmail.com]:587

🔐 Part 3: Create App Password in Google

You need this because Gmail blocks Postfix from using your real password.

🔗 Get your Gmail App Password here

    📌 You must have 2-Step Verification turned on for your Google account first.

🔏 Part 4: Store credentials securely

    Create /etc/postfix/sasl_passwd:

sudo nano /etc/postfix/sasl_passwd

Add this line (replace with your email + real app password):

[smtp.gmail.com]:587    your.email@gmail.com:your_app_password

✅ Example:

[smtp.gmail.com]:587    jorgegcintron@gmail.com:caqy xogp qcuq ihlc

    Secure the file and generate the hash:

sudo chmod 600 /etc/postfix/sasl_passwd
sudo postmap /etc/postfix/sasl_passwd

    Reload Postfix to apply changes:

sudo systemctl reload postfix

✉️ Part 5: Test email sending

Send a test email:

echo "This is a test from z/OS bridge" | mail -s "Mainframe Alert" your@email.com

✅ You should see the email appear in your inbox.
🧪 Optional: Check logs if something breaks

sudo journalctl -u postfix -e

or

tail -n 50 /var/log/mail.log









✅ Basic Command to Send Email:

echo "Your message body" | mail -s "Your Subject Here" recipient@email.com

📌 Examples:
Send a simple message:

echo "Mainframe job completed successfully." | mail -s "Job Status" jorgegcintron@gmail.com

Send the contents of a file (like a report or log):

mail -s "Mainframe Report" jorgegcintron@gmail.com < /path/to/file.txt

🧠 Tips

    You can run this from any shell script or cron job.

    You can FTP a file from z/OS to Linux, then:

mail -s "z/OS Alert" jorgegcintron@gmail.com < /home/jtron/ftp/zmsg.txt

You can also attach files with mutt or mailx if needed — just ask if you want that.



🧱 1. Set up FTP server on Linux (vsftpd)

sudo apt install vsftpd

Then edit the config:

sudo nano /etc/vsftpd.conf

✅ Ensure these lines are set:

local_enable=YES
write_enable=YES
chroot_local_user=YES
allow_writeable_chroot=YES

    These lines are critical — they:

    Enable local user logins

    Allow writing

    Jail users to their home directory (for security)

    Allow that home to be writable (vsftpd blocks this by default unless explicitly allowed)

Then restart the service:

sudo systemctl restart vsftpd

🛡️ 2. Fix Linux permissions

You were using the user jtron, so you ran:

sudo chown -R jtron:jtron /home/jtron
sudo chmod 755 /home/jtron

At one point, we tested with incoming_mail, but due to chroot jail, you couldn’t cd into that from FTP. So we simplified by writing directly into the home directory.
🧪 3. Tested FTP login from Linux

ftp localhost

    Username: jtron

    Password: !Soldierghost92

Verified that login worked ✅
🧪 4. Validated the login from z/OS TSO

From the TSO READY prompt:

ftp 192.168.4.250

Then you entered:

User: jtron
Password: !Soldierghost92

cd .     <-- This kept you in the home directory
bin
put 'IBMUSER.EMAIL.MSG' email.txt
quit

✅ This finally worked, and you saw:

226 Transfer complete.

And the file appeared in /home/jtron/email.txt.
🧾 Optional: How you prepared the dataset

From ISPF (option 3.4), you created or edited IBMUSER.EMAIL.MSG with:

Mainframe to Linux FTP bridge working!
This will be sent by Postfix email.

📥 End Result

You successfully uploaded a mainframe dataset as a Linux file, paving the way for automated email via Postfix.
